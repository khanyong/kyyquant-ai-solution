# 계좌 잔고 0원 문제 원인 및 해결방법

## 🔍 문제 원인

**`kw_account_balance` 테이블에 데이터가 없습니다!**

```
계좌 잔고 조회 오류: {
  code: 'PGRST116',
  details: 'The result contains 0 rows',
  hint: null,
  message: 'Cannot coerce the result to a single JSON object'
}
```

## 📊 현재 상태

### ✅ 전략 설정은 완료됨
- **활성 전략**: [템플릿] 볼린저밴드
- **자동매매**: ✅ 활성화 (auto_trade_enabled: true, auto_execute: true)
- **할당율**: 100%
- **모니터링 종목**: 005930 (삼성전자), 000660 (SK하이닉스), 035420 (네이버), 035720 (카카오)

### ❌ 계좌 잔고가 DB에 없음
- `kw_account_balance` 테이블: **0 rows (빈 테이블)**
- 따라서 할당 금액을 계산할 수 없음

## ✅ 해결 방법

### 1. UI에서 "계좌 동기화" 버튼 클릭

프론트엔드에서 **"계좌 동기화"** 버튼을 클릭하면:

```
Kiwoom API 호출
   ↓
kw_account_balance 테이블 업데이트
   ↓
available_cash: 9,782,702원 (이전 스크린샷에서 확인한 금액)
```

### 2. 동기화 후 예상 결과

계좌 동기화 완료 후:
- **사용 가능 현금**: 9,782,702원
- **할당 금액** (100%): 9,782,702원
- **전략당 최대 매수 금액**: 약 2,445,675원 (4종목 분산)

## 🎯 다음 단계

1. **UI에서 "계좌 동기화" 버튼 클릭** ← 지금 즉시 실행
2. 동기화 완료 후 `scripts/check_account_balance.js` 재실행하여 확인
3. 1-2분 대기 후 n8n workflow-v7-1이 strategy_monitoring 테이블 업데이트
4. 조건 충족 시 자동으로 시그널 발생 및 주문 생성

## 📝 참고

- 계좌 동기화는 수동으로 해야 함 (버튼 클릭 필요)
- 동기화 후에는 UI에서 실시간으로 잔고 및 할당 금액이 표시됨
- 이전 세션에서 9,782,702원이 확인되었으므로, 동기화만 하면 정상 작동할 것으로 예상

## 🚨 중요

**SQL로 해결할 수 없는 문제입니다.** 반드시 UI에서 "계좌 동기화" 버튼을 클릭해야 합니다.

이 버튼이 Kiwoom API를 호출하여 실시간 계좌 잔고를 가져와 DB에 저장합니다.
