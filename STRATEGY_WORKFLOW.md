# 📊 전략빌더 → 백테스팅 완전 통합 가이드

## 🔄 전체 워크플로우

```mermaid
graph LR
    A[전략빌더] --> B[전략 생성]
    B --> C[Supabase 저장]
    C --> D[백테스트 페이지]
    D --> E[전략 선택]
    E --> F[백테스트 실행]
    F --> G[결과 분석]
```

## 1️⃣ 전략빌더에서 전략 생성

### 다양한 전략 타입 생성 가능:

#### 📈 **이동평균 전략 (SMA/EMA)**
```javascript
- 지표: SMA(20), SMA(60)
- 매수 조건: 단기선 > 장기선 (골든크로스)
- 매도 조건: 단기선 < 장기선 (데드크로스)
```

#### 📊 **RSI 전략**
```javascript
- 지표: RSI(14)
- 매수 조건: RSI < 30 (과매도)
- 매도 조건: RSI > 70 (과매수)
```

#### 📉 **볼린저 밴드 전략**
```javascript
- 지표: BB(20, 2)
- 매수 조건: 가격 < 하단밴드
- 매도 조건: 가격 > 상단밴드
```

#### 🌊 **MACD 전략**
```javascript
- 지표: MACD(12, 26, 9)
- 매수 조건: MACD선 > 시그널선
- 매도 조건: MACD선 < 시그널선
```

#### 🎌 **일목균형표 전략**
```javascript
- 지표: 일목균형표
- 매수 조건: 구름대 상단 돌파
- 매도 조건: 구름대 하단 돌파
```

## 2️⃣ 전략 저장 방법

### **A. 즉시 저장**
1. 전략 구성 완료
2. 상단 "저장" 버튼 클릭
3. Supabase에 자동 저장
4. 저장 완료 알림

### **B. 저장 후 백테스팅**
1. 전략 구성 완료
2. "전략 저장 후 백테스팅" 버튼 클릭
3. 자동으로 저장 & 백테스트 페이지 이동
4. 해당 전략 자동 선택됨

## 3️⃣ 백테스팅에서 전략 선택 및 실행

### **전략 선택 방법:**

#### **방법 1: 드롭다운에서 선택**
```
1. 백테스트 페이지 접속
2. "전략 선택" 드롭다운 클릭
3. 저장된 전략 목록 확인
   - 전략명
   - 전략 타입
   - 생성일자
   - 설명
4. 원하는 전략 선택
```

#### **방법 2: URL 직접 접근**
```
http://localhost:3000/backtest?strategyId=[전략ID]
```

#### **방법 3: 전략빌더에서 자동 이동**
```
전략빌더 → "전략 저장 후 백테스팅" → 자동 선택
```

### **백테스트 실행 설정:**
```yaml
기간 설정:
  - 시작일: 1년 전 (기본값)
  - 종료일: 오늘
  
자본금:
  - 초기 자본금: 10,000,000원
  
수수료:
  - 거래 수수료: 0.015%
  - 슬리피지: 0.1%
  
종목:
  - 비워두기: 주요 종목 자동 선택
  - 직접 입력: "005930, 000660" (쉼표 구분)
  
데이터 간격:
  - 1분 / 5분 / 15분 / 30분 / 1시간 / 1일
```

## 4️⃣ 전략 관리

### **저장된 전략 보기:**
1. 전략빌더 → "불러오기" 버튼
2. Supabase 저장 전략 목록
3. 클릭하여 불러오기 또는 삭제

### **전략 수정:**
1. 기존 전략 불러오기
2. 파라미터 수정
3. 다시 저장 (새 버전 생성)

### **전략 삭제:**
1. 전략 목록에서 삭제 아이콘 클릭
2. 확인 후 Supabase에서 삭제

## 5️⃣ 실제 사용 예시

### **예시 1: 단순 이동평균 전략**
```
1. 전략빌더 접속
2. 이름: "20-60 골든크로스"
3. 지표 추가:
   - SMA (period: 20)
   - SMA (period: 60)
4. 매수 조건: SMA(20) > SMA(60)
5. 매도 조건: SMA(20) < SMA(60)
6. 리스크 관리:
   - 손절: -3%
   - 익절: 10%
7. "저장" 클릭
8. 백테스트 페이지 이동
9. "20-60 골든크로스" 선택
10. 실행
```

### **예시 2: RSI + 볼린저 복합 전략**
```
1. 전략빌더 접속
2. 이름: "RSI-BB 복합 전략"
3. 지표 추가:
   - RSI (period: 14)
   - 볼린저밴드 (period: 20, stdDev: 2)
4. 매수 조건:
   - RSI < 30 AND
   - 가격 < BB 하단
5. 매도 조건:
   - RSI > 70 OR
   - 가격 > BB 상단
6. "전략 저장 후 백테스팅" 클릭
7. 자동으로 백테스트 페이지로 이동
8. 기간 설정 후 실행
```

## 6️⃣ 백테스트 결과 해석

### **주요 지표:**
- **Total Return**: 총 수익률
- **Annual Return**: 연환산 수익률  
- **Sharpe Ratio**: 위험조정 수익률 (> 1.0 양호)
- **Max Drawdown**: 최대 낙폭 (< 20% 양호)
- **Win Rate**: 승률 (> 50% 양호)
- **Total Trades**: 총 거래 횟수

### **결과 활용:**
1. 수익률이 낮은 경우 → 파라미터 조정
2. 낙폭이 큰 경우 → 리스크 관리 강화
3. 거래 횟수 과다 → 조건 엄격하게 조정
4. 승률이 낮은 경우 → 진입 조건 개선

## 7️⃣ 팁 & 주의사항

### ✅ **Best Practices:**
- 최소 1년 이상 데이터로 백테스트
- 여러 시장 상황 포함 (상승/하락/횡보)
- 거래 비용 현실적으로 설정
- 과최적화 주의

### ⚠️ **주의사항:**
- 과거 성과 ≠ 미래 수익 보장
- 백테스트는 참고용
- 실전에서는 심리적 요인 고려
- 시장 상황 변화 주의

## 8️⃣ 문제 해결

### **전략이 저장되지 않는 경우:**
- 전략 이름 입력 확인
- 최소 1개 이상 지표 추가 필요
- 네트워크 연결 확인

### **백테스트에서 전략이 보이지 않는 경우:**
- 전략빌더에서 저장 확인
- 새로고침 실행
- is_active 상태 확인

### **백테스트 실행 오류:**
- 날짜 범위 확인 (시작일 < 종료일)
- 초기 자본금 0 이상
- 전략 ID 유효성 확인

## 📞 지원

문제가 있으시면 다음을 확인해주세요:
1. Supabase 연결 상태
2. 전략 저장 여부
3. 백테스트 API 상태