# í˜„ì¬ ìš´ì˜ ì¤‘ì¸ ì‹œìŠ¤í…œ ê°œì„  ê³„íš

## ğŸ“Š í˜„ì¬ ìš´ì˜ ìƒíƒœ

### ğŸŸ¢ í˜„ì¬ ê°€ëŠ¥í•œ ê¸°ëŠ¥ (Vercel + Supabase)
- âœ… **ì „ëµ ë¹Œë”**: ì‚¬ìš©ìê°€ íˆ¬ì ì „ëµ êµ¬ì„±
- âœ… **ë°±í…ŒìŠ¤íŒ…**: ê³¼ê±° ë°ì´í„°ë¡œ ì „ëµ ê²€ì¦
- âœ… **íˆ¬ì ì„¤ì •**: íˆ¬ì ìœ ë‹ˆë²„ìŠ¤, í•„í„° ì„¤ì •
- âœ… **ë°ì´í„° ì €ì¥**: Supabaseì— ì „ëµ/ê²°ê³¼ ì €ì¥
- âœ… **ì‚¬ìš©ì ì¸ì¦**: Supabase Auth
- âœ… **ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸**: Supabase Realtime

### ğŸ”´ í˜„ì¬ ë¶ˆê°€ëŠ¥í•œ ê¸°ëŠ¥
- âŒ **ì‹¤ì œ ì£¼ë¬¸ ì‹¤í–‰**: ì¦ê¶Œì‚¬ API ì—°ë™ í•„ìš”
- âŒ **ì‹¤ì‹œê°„ ì‹œì„¸ ìˆ˜ì§‘**: Windows ê¸°ë°˜ API ì œì•½
- âŒ **ìë™ ë§¤ë§¤**: 24/7 ì‹¤í–‰ í™˜ê²½ í•„ìš”
- âŒ **ëŒ€ìš©ëŸ‰ ë°±í…ŒìŠ¤íŠ¸**: ì—°ì‚° ë¦¬ì†ŒìŠ¤ ì œí•œ

---

## ğŸ—ï¸ í˜„ì¬ ì•„í‚¤í…ì²˜ì™€ ê°œì„ ì•ˆ

### í˜„ì¬ êµ¬ì¡°
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ì‚¬ìš©ì (ì›¹ ë¸Œë¼ìš°ì €)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Vercel (í˜„ì¬ ìš´ì˜ ì¤‘)               â”‚
â”‚  - React Frontend                      â”‚
â”‚  - ì „ëµ ë¹Œë” UI                         â”‚
â”‚  - ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì‹œê°í™”                   â”‚
â”‚  - íˆ¬ì ì„¤ì • ê´€ë¦¬                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Supabase (í˜„ì¬ ìš´ì˜ ì¤‘)             â”‚
â”‚  - PostgreSQL DB                       â”‚
â”‚  - ì‚¬ìš©ì ì¸ì¦                          â”‚
â”‚  - ì „ëµ/ë°±í…ŒìŠ¤íŠ¸ ë°ì´í„° ì €ì¥              â”‚
â”‚  - Realtime êµ¬ë…                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
        âš ï¸ ì‹¤ì œ ê±°ë˜ ë¶ˆê°€ëŠ¥ (API ì—°ë™ X)
```

### ê°œì„ ëœ êµ¬ì¡° (NAS ì¶”ê°€)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ì‚¬ìš©ì (ì›¹/ëª¨ë°”ì¼)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Vercel (ê¸°ì¡´ ìœ ì§€ + í™•ì¥)           â”‚
â”‚  - React Frontend âœ…                   â”‚
â”‚  - ì „ëµ ë¹Œë” UI âœ…                      â”‚
â”‚  - ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì‹œê°í™” âœ…               â”‚
â”‚  - íˆ¬ì ì„¤ì • ê´€ë¦¬ âœ…                    â”‚
â”‚  + API Routes (ì‹ ê·œ)                   â”‚
â”‚  + ì£¼ë¬¸ ê´€ë¦¬ UI (ì‹ ê·œ)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Supabase (ê¸°ì¡´ ìœ ì§€ + í™•ì¥)         â”‚
â”‚  - PostgreSQL DB âœ…                    â”‚
â”‚  - ì‚¬ìš©ì ì¸ì¦ âœ…                       â”‚
â”‚  - ì „ëµ/ë°±í…ŒìŠ¤íŠ¸ ë°ì´í„° âœ…               â”‚
â”‚  - Realtime êµ¬ë… âœ…                    â”‚
â”‚  + Edge Functions (ì‹ ê·œ)               â”‚
â”‚  + ì£¼ë¬¸/í¬ì§€ì…˜ í…Œì´ë¸” (ì‹ ê·œ)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Synology NAS (ì‹ ê·œ ì¶”ê°€)             â”‚
â”‚  - ì¦ê¶Œì‚¬ API ë¸Œë¦¿ì§€                    â”‚
â”‚  - ì‹¤ì‹œê°„ ì‹œì„¸ ìˆ˜ì§‘                     â”‚
â”‚  - ìë™ ë§¤ë§¤ ì‹¤í–‰                      â”‚
â”‚  - ëŒ€ìš©ëŸ‰ ë°±í…ŒìŠ¤íŠ¸ ì—”ì§„                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ ë‹¨ê³„ë³„ ê°œì„  ê³„íš

### Phase 0: í˜„ì¬ ì‹œìŠ¤í…œ ìµœì í™” (1ì£¼)
ê¸°ì¡´ ìš´ì˜ ì¤‘ì¸ ê¸°ëŠ¥ì„ ìœ ì§€í•˜ë©´ì„œ ì¤€ë¹„ ì‘ì—…

#### 0.1 ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ í™•ì¥
```sql
-- ìƒˆë¡œìš´ í…Œì´ë¸” ì¶”ê°€ (Supabase)

-- ì¦ê¶Œì‚¬ ê³„ì • ì •ë³´
CREATE TABLE broker_accounts (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id),
  broker_type TEXT NOT NULL, -- 'kis', 'ebest', 'ls'
  account_number TEXT,
  encrypted_credentials JSONB, -- ì•”í˜¸í™”ëœ API í‚¤
  is_paper_account BOOLEAN DEFAULT true,
  is_active BOOLEAN DEFAULT false,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- ì‹¤ì œ ì£¼ë¬¸ ë‚´ì—­
CREATE TABLE real_orders (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id),
  broker_account_id UUID REFERENCES broker_accounts(id),
  stock_code TEXT NOT NULL,
  order_type TEXT NOT NULL, -- 'buy', 'sell'
  order_status TEXT NOT NULL, -- 'pending', 'executed', 'cancelled'
  quantity INTEGER NOT NULL,
  price DECIMAL(10,2),
  executed_price DECIMAL(10,2),
  broker_order_id TEXT, -- ì¦ê¶Œì‚¬ ì£¼ë¬¸ë²ˆí˜¸
  strategy_id UUID REFERENCES strategies(id),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  executed_at TIMESTAMPTZ
);

-- ì‹¤ì‹œê°„ í¬ì§€ì…˜
CREATE TABLE real_positions (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id),
  broker_account_id UUID REFERENCES broker_accounts(id),
  stock_code TEXT NOT NULL,
  quantity INTEGER NOT NULL,
  avg_price DECIMAL(10,2),
  current_price DECIMAL(10,2),
  profit_loss DECIMAL(10,2),
  profit_loss_rate DECIMAL(5,2),
  updated_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(broker_account_id, stock_code)
);

-- RLS ì •ì±… ì¶”ê°€
ALTER TABLE broker_accounts ENABLE ROW LEVEL SECURITY;
ALTER TABLE real_orders ENABLE ROW LEVEL SECURITY;
ALTER TABLE real_positions ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can manage own broker accounts" ON broker_accounts
  FOR ALL USING (auth.uid() = user_id);

CREATE POLICY "Users can view own orders" ON real_orders
  FOR ALL USING (auth.uid() = user_id);

CREATE POLICY "Users can view own positions" ON real_positions
  FOR ALL USING (auth.uid() = user_id);
```

#### 0.2 Vercel API Routes ì¤€ë¹„
```typescript
// app/api/trading/route.ts (ìƒˆë¡œ ì¶”ê°€)
import { NextRequest, NextResponse } from 'next/server'
import { createClient } from '@supabase/supabase-js'

export async function POST(request: NextRequest) {
  const supabase = createClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.SUPABASE_SERVICE_ROLE_KEY!
  )
  
  // ì‚¬ìš©ì ì¸ì¦ í™•ì¸
  const token = request.headers.get('authorization')?.replace('Bearer ', '')
  const { data: { user } } = await supabase.auth.getUser(token)
  
  if (!user) {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })
  }
  
  const { action, stockCode, quantity, price } = await request.json()
  
  // NAS ì„œë²„ë¡œ ì£¼ë¬¸ ì „ë‹¬ (Phase 1ì—ì„œ êµ¬í˜„)
  // í˜„ì¬ëŠ” ì£¼ë¬¸ì„ DBì—ë§Œ ì €ì¥
  const { data, error } = await supabase
    .from('real_orders')
    .insert({
      user_id: user.id,
      stock_code: stockCode,
      order_type: action,
      order_status: 'pending',
      quantity,
      price
    })
    .select()
    .single()
  
  if (error) {
    return NextResponse.json({ error: error.message }, { status: 400 })
  }
  
  return NextResponse.json(data)
}
```

---

### Phase 1: NAS ì„œë²„ êµ¬ì¶• (2ì£¼)
ê¸°ì¡´ ì‹œìŠ¤í…œì€ ê·¸ëŒ€ë¡œ ìš´ì˜í•˜ë©´ì„œ NAS ì¶”ê°€

#### 1.1 NAS Docker í™˜ê²½ ì„¤ì •
```yaml
# docker-compose.yml
version: '3.8'

services:
  # API ê²Œì´íŠ¸ì›¨ì´
  api-gateway:
    build: ./gateway
    ports:
      - "8080:8080"
    environment:
      - SUPABASE_URL=${SUPABASE_URL}
      - SUPABASE_SERVICE_KEY=${SUPABASE_SERVICE_KEY}
    depends_on:
      - trading-service
      - market-service

  # ê±°ë˜ ì„œë¹„ìŠ¤
  trading-service:
    build: ./services/trading
    environment:
      - SUPABASE_URL=${SUPABASE_URL}
      - SUPABASE_SERVICE_KEY=${SUPABASE_SERVICE_KEY}
    volumes:
      - ./credentials:/app/credentials
    ports:
      - "8081:8081"

  # ì‹œì¥ ë°ì´í„° ì„œë¹„ìŠ¤
  market-service:
    build: ./services/market
    environment:
      - SUPABASE_URL=${SUPABASE_URL}
      - SUPABASE_SERVICE_KEY=${SUPABASE_SERVICE_KEY}
    volumes:
      - market-data:/app/data
    ports:
      - "8082:8082"

  # ë°±í…ŒìŠ¤íŠ¸ ì›Œì»¤
  backtest-worker:
    build: ./services/backtest
    environment:
      - SUPABASE_URL=${SUPABASE_URL}
      - SUPABASE_SERVICE_KEY=${SUPABASE_SERVICE_KEY}
    deploy:
      replicas: 3

volumes:
  market-data:
  credentials:
```

#### 1.2 ì¦ê¶Œì‚¬ API ë¸Œë¦¿ì§€
```python
# services/trading/broker_manager.py
from typing import Dict, Any
import asyncio
from supabase import create_client
import os

class BrokerManager:
    def __init__(self):
        self.supabase = create_client(
            os.environ['SUPABASE_URL'],
            os.environ['SUPABASE_SERVICE_KEY']
        )
        self.brokers = {}
    
    async def initialize_broker(self, user_id: str, broker_type: str):
        """ì‚¬ìš©ìì˜ ë¸Œë¡œì»¤ ì—°ê²° ì´ˆê¸°í™”"""
        # Supabaseì—ì„œ ì•”í˜¸í™”ëœ ì¸ì¦ì •ë³´ ì¡°íšŒ
        response = self.supabase.table('broker_accounts')\
            .select('*')\
            .eq('user_id', user_id)\
            .eq('broker_type', broker_type)\
            .single()\
            .execute()
        
        if not response.data:
            raise Exception("Broker account not found")
        
        account = response.data
        
        # ë¸Œë¡œì»¤ë³„ API ì´ˆê¸°í™”
        if broker_type == 'kis':
            from .brokers.kis import KISBroker
            broker = KISBroker(account['encrypted_credentials'])
        elif broker_type == 'ebest':
            from .brokers.ebest import EbestBroker
            broker = EbestBroker(account['encrypted_credentials'])
        else:
            raise Exception(f"Unknown broker type: {broker_type}")
        
        self.brokers[user_id] = broker
        return broker
    
    async def execute_order(self, user_id: str, order: Dict[str, Any]):
        """ì£¼ë¬¸ ì‹¤í–‰"""
        if user_id not in self.brokers:
            await self.initialize_broker(
                user_id, 
                order.get('broker_type', 'kis')
            )
        
        broker = self.brokers[user_id]
        
        # ì£¼ë¬¸ ì‹¤í–‰
        result = await broker.place_order(order)
        
        # ê²°ê³¼ë¥¼ Supabaseì— ì—…ë°ì´íŠ¸
        await self.update_order_status(order['id'], result)
        
        # ì‹¤ì‹œê°„ ì•Œë¦¼ (Supabase Realtime)
        await self.notify_user(user_id, result)
        
        return result
    
    async def update_order_status(self, order_id: str, result: Dict[str, Any]):
        """ì£¼ë¬¸ ìƒíƒœ ì—…ë°ì´íŠ¸"""
        self.supabase.table('real_orders')\
            .update({
                'order_status': result['status'],
                'broker_order_id': result.get('order_id'),
                'executed_price': result.get('executed_price'),
                'executed_at': result.get('executed_at')
            })\
            .eq('id', order_id)\
            .execute()
```

---

### Phase 2: ì—°ë™ ë° í…ŒìŠ¤íŠ¸ (2ì£¼)
Vercelê³¼ NAS ì—°ë™

#### 2.1 Vercelì—ì„œ NAS API í˜¸ì¶œ
```typescript
// app/api/trading/execute/route.ts
import { NextRequest, NextResponse } from 'next/server'

export async function POST(request: NextRequest) {
  const { orderId, userId } = await request.json()
  
  // NAS ì„œë²„ë¡œ ì£¼ë¬¸ ì‹¤í–‰ ìš”ì²­
  const nasResponse = await fetch(
    `${process.env.NAS_API_URL}/api/v1/trading/execute`,
    {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-API-Key': process.env.NAS_API_KEY!
      },
      body: JSON.stringify({ orderId, userId })
    }
  )
  
  if (!nasResponse.ok) {
    return NextResponse.json(
      { error: 'Failed to execute order' },
      { status: 500 }
    )
  }
  
  const result = await nasResponse.json()
  return NextResponse.json(result)
}
```

#### 2.2 í”„ë¡ íŠ¸ì—”ë“œ ì—…ë°ì´íŠ¸
```typescript
// src/components/RealTrading.tsx
import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'

export function RealTrading() {
  const [orders, setOrders] = useState([])
  const [positions, setPositions] = useState([])
  
  useEffect(() => {
    // ì‹¤ì‹œê°„ ì£¼ë¬¸ ìƒíƒœ êµ¬ë…
    const ordersChannel = supabase
      .channel('orders-changes')
      .on('postgres_changes',
        {
          event: '*',
          schema: 'public',
          table: 'real_orders',
          filter: `user_id=eq.${userId}`
        },
        (payload) => {
          if (payload.eventType === 'UPDATE') {
            setOrders(prev => 
              prev.map(o => o.id === payload.new.id ? payload.new : o)
            )
          } else if (payload.eventType === 'INSERT') {
            setOrders(prev => [...prev, payload.new])
          }
        }
      )
      .subscribe()
    
    // ì‹¤ì‹œê°„ í¬ì§€ì…˜ ì—…ë°ì´íŠ¸
    const positionsChannel = supabase
      .channel('positions-changes')
      .on('postgres_changes',
        {
          event: '*',
          schema: 'public',
          table: 'real_positions',
          filter: `user_id=eq.${userId}`
        },
        (payload) => {
          setPositions(prev => 
            prev.map(p => p.stock_code === payload.new.stock_code 
              ? payload.new 
              : p
            )
          )
        }
      )
      .subscribe()
    
    return () => {
      supabase.removeChannel(ordersChannel)
      supabase.removeChannel(positionsChannel)
    }
  }, [userId])
  
  const executeOrder = async (stockCode: string, quantity: number) => {
    const response = await fetch('/api/trading/execute', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${session.access_token}`
      },
      body: JSON.stringify({
        stockCode,
        quantity,
        orderType: 'market'
      })
    })
    
    const result = await response.json()
    console.log('Order executed:', result)
  }
  
  return (
    <div>
      {/* ì‹¤ì‹œê°„ ì£¼ë¬¸/í¬ì§€ì…˜ UI */}
    </div>
  )
}
```

---

### Phase 3: ì ì§„ì  ê¸°ëŠ¥ í™•ì¥ (2-3ì£¼)

#### 3.1 ëª¨ì˜íˆ¬ì â†’ ì‹¤ì „íˆ¬ì ì „í™˜
```typescript
// ì‚¬ìš©ì ê¶Œí•œ ê´€ë¦¬
interface UserTradingPermission {
  userId: string
  canPaperTrade: boolean  // ëª¨ì˜íˆ¬ì
  canRealTrade: boolean   // ì‹¤ì „íˆ¬ì
  dailyTradeLimit: number
  maxPositionSize: number
  verifiedAt: Date | null
}

// ê¶Œí•œ ì²´í¬ ë¯¸ë“¤ì›¨ì–´
export async function checkTradingPermission(
  userId: string, 
  isRealTrade: boolean
): Promise<boolean> {
  const { data } = await supabase
    .from('trading_permissions')
    .select('*')
    .eq('user_id', userId)
    .single()
  
  if (!data) return false
  
  if (isRealTrade && !data.can_real_trade) {
    throw new Error('Real trading not allowed for this user')
  }
  
  return true
}
```

#### 3.2 ìë™ë§¤ë§¤ ìŠ¤ì¼€ì¤„ëŸ¬
```python
# services/scheduler/auto_trader.py
import asyncio
from apscheduler.schedulers.asyncio import AsyncIOScheduler
from datetime import datetime

class AutoTrader:
    def __init__(self):
        self.scheduler = AsyncIOScheduler()
        self.active_strategies = {}
    
    async def start(self):
        """ìë™ë§¤ë§¤ ìŠ¤ì¼€ì¤„ëŸ¬ ì‹œì‘"""
        # ì¥ ì‹œì‘ ì „ ì¤€ë¹„
        self.scheduler.add_job(
            self.prepare_market_open,
            'cron',
            hour=8,
            minute=30
        )
        
        # ì¥ì¤‘ ì „ëµ ì‹¤í–‰ (1ë¶„ë§ˆë‹¤)
        self.scheduler.add_job(
            self.execute_strategies,
            'cron',
            hour='9-15',
            minute='*',
            second=0
        )
        
        # ì¥ ë§ˆê° ì •ë¦¬
        self.scheduler.add_job(
            self.market_close_cleanup,
            'cron',
            hour=15,
            minute=35
        )
        
        self.scheduler.start()
    
    async def execute_strategies(self):
        """í™œì„±í™”ëœ ì „ëµ ì‹¤í–‰"""
        # Supabaseì—ì„œ í™œì„± ì „ëµ ì¡°íšŒ
        active = await self.get_active_strategies()
        
        for strategy in active:
            try:
                # ì „ëµ ì¡°ê±´ ì²´í¬
                signals = await self.check_strategy_conditions(strategy)
                
                if signals:
                    # ì£¼ë¬¸ ì‹¤í–‰
                    await self.execute_orders(strategy, signals)
            except Exception as e:
                await self.log_error(strategy['id'], str(e))
```

---

## ğŸ“Š ì„±ëŠ¥ ë° í™•ì¥ì„±

### í˜„ì¬ vs ê°œì„  í›„ ë¹„êµ

| í•­ëª© | í˜„ì¬ (Vercel+Supabase) | ê°œì„  í›„ (+NAS) |
|------|------------------------|----------------|
| **ì „ëµ ë¹Œë”** | âœ… ê°€ëŠ¥ | âœ… ìœ ì§€ |
| **ë°±í…ŒìŠ¤íŠ¸** | âœ… ì œí•œì  (ë¸Œë¼ìš°ì €) | âœ… ëŒ€ìš©ëŸ‰ ê°€ëŠ¥ |
| **ëª¨ì˜íˆ¬ì** | âš ï¸ ìˆ˜ë™ | âœ… ìë™ |
| **ì‹¤ì „íˆ¬ì** | âŒ ë¶ˆê°€ | âœ… ê°€ëŠ¥ |
| **ì‹¤ì‹œê°„ ì‹œì„¸** | âŒ ë¶ˆê°€ | âœ… ê°€ëŠ¥ |
| **ìë™ë§¤ë§¤** | âŒ ë¶ˆê°€ | âœ… 24/7 |
| **ë™ì‹œ ì‚¬ìš©ì** | 100ëª… | 1,000ëª…+ |
| **ì‘ë‹µ ì†ë„** | 200ms | 100ms |

### ë¹„ìš© ë¶„ì„

#### í˜„ì¬ ë¹„ìš© (ì›”)
- Vercel: $0 (ë¬´ë£Œ í‹°ì–´)
- Supabase: $0-25 (ë¬´ë£Œ/Pro)
- **í•©ê³„**: $0-25

#### ê°œì„  í›„ ë¹„ìš© (ì›”)
- Vercel: $0-20 (ë¬´ë£Œ/Pro)
- Supabase: $25 (Pro)
- NAS ì „ë ¥: ~$10
- ì¦ê¶Œì‚¬ API: $0
- **í•©ê³„**: $35-55

---

## ğŸ¯ í•µì‹¬ ì´ì 

### 1. **ê¸°ì¡´ ì‹œìŠ¤í…œ ìœ ì§€**
- ìš´ì˜ ì¤‘ì¸ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ì—†ìŒ
- ì ì§„ì  ê¸°ëŠ¥ ì¶”ê°€
- ì‚¬ìš©ì ê²½í—˜ ì—°ì†ì„±

### 2. **ì‹¤ì „ ê±°ë˜ ê°€ëŠ¥**
- ì¦ê¶Œì‚¬ API ì—°ë™
- ì‹¤ì‹œê°„ ì£¼ë¬¸ ì‹¤í–‰
- í¬ì§€ì…˜ ê´€ë¦¬

### 3. **í™•ì¥ì„±**
- ë‹¤ì¤‘ ì‚¬ìš©ì ì§€ì›
- ìë™ ìŠ¤ì¼€ì¼ë§
- ë³‘ë ¬ ë°±í…ŒìŠ¤íŠ¸

### 4. **24/7 ìš´ì˜**
- NAS ìƒì‹œ ê°€ë™
- ìë™ë§¤ë§¤ ìŠ¤ì¼€ì¤„ëŸ¬
- ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§

---

## ğŸš¦ ì¦‰ì‹œ ì‹œì‘ ê°€ëŠ¥í•œ ì‘ì—…

### Week 1: ì¤€ë¹„
- [ ] Supabase ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸
- [ ] Vercel API Routes ì¶”ê°€
- [ ] NAS Docker í™˜ê²½ ì„¤ì •

### Week 2: ê°œë°œ
- [ ] ì¦ê¶Œì‚¬ API ë¸Œë¦¿ì§€ êµ¬í˜„
- [ ] ì£¼ë¬¸ ì‹¤í–‰ ë¡œì§
- [ ] ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸

### Week 3: í…ŒìŠ¤íŠ¸
- [ ] ëª¨ì˜íˆ¬ì í…ŒìŠ¤íŠ¸
- [ ] ë¶€í•˜ í…ŒìŠ¤íŠ¸
- [ ] ë³´ì•ˆ ì ê²€

### Week 4: ë°°í¬
- [ ] ë‹¨ê³„ì  ë¡¤ì•„ì›ƒ
- [ ] ëª¨ë‹ˆí„°ë§ ì„¤ì •
- [ ] ì‚¬ìš©ì ê°€ì´ë“œ

ì´ë ‡ê²Œ í•˜ë©´ í˜„ì¬ ìš´ì˜ ì¤‘ì¸ ì‹œìŠ¤í…œì„ ì¤‘ë‹¨í•˜ì§€ ì•Šê³  ì‹¤ì „ ê±°ë˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.