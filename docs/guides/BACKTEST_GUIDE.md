# 📈 백테스팅 전략 선택 및 실행 가이드

## 1️⃣ Supabase에 전략 등록

1. **Supabase 대시보드 접속**
   - https://supabase.com/dashboard/project/hznkyaomtrpzcayayayh
   - SQL Editor 클릭

2. **전략 등록 SQL 실행**
   ```sql
   -- supabase/insert-strategies.sql 파일 내용 복사하여 실행
   ```

## 2️⃣ 웹 UI에서 백테스트 실행

### 방법 1: React 앱에서 실행
1. **앱 실행**
   ```bash
   npm run dev
   ```

2. **백테스트 페이지 접속**
   - http://localhost:3000/backtest

3. **전략 선택**
   - 드롭다운에서 원하는 전략 선택
   - 예: "이동평균선 교차 전략", "RSI 과매수/과매도" 등

4. **파라미터 설정**
   - 시작일: 백테스트 시작 날짜
   - 종료일: 백테스트 종료 날짜
   - 초기 자본금: 1000만원 (기본값)
   - 수수료율: 0.015% (키움증권 기준)
   - 슬리피지: 0.1%

5. **종목 선택 (선택사항)**
   - 비워두면: 주요 종목 자동 선택
   - 직접 입력: "005930, 000660" (쉼표로 구분)

6. **실행**
   - "백테스트 실행" 버튼 클릭
   - 진행률 확인
   - 완료 후 "결과 보기" 클릭

## 3️⃣ 전략별 특징

### 🔹 이동평균선 교차 전략
- **적합한 시장**: 추세가 명확한 시장
- **장점**: 단순하고 직관적
- **단점**: 횡보장에서 손실 가능
- **파라미터 조정**: 
  - 단기선: 5~20일
  - 장기선: 20~120일

### 🔹 RSI 전략
- **적합한 시장**: 박스권 횡보장
- **장점**: 과매수/과매도 포착
- **단점**: 강한 추세장에서 역효과
- **파라미터 조정**:
  - RSI 기간: 9~21일
  - 과매도선: 20~30
  - 과매수선: 70~80

### 🔹 모멘텀 전략
- **적합한 시장**: 상승장
- **장점**: 강한 종목 선별
- **단점**: 급락시 손실 확대
- **파라미터 조정**:
  - 관찰 기간: 10~60일
  - 진입 임계값: 3~10%

### 🔹 볼린저 밴드
- **적합한 시장**: 변동성이 큰 시장
- **장점**: 변동성 기반 매매
- **단점**: 추세장에서 조기 청산
- **파라미터 조정**:
  - 기간: 10~30일
  - 표준편차: 1.5~2.5

## 4️⃣ API로 직접 실행

```python
import requests

# 백테스트 실행
response = requests.post('http://localhost:5000/api/backtest/run', json={
    'strategy_id': 'your-strategy-uuid',
    'start_date': '2023-01-01',
    'end_date': '2024-01-01',
    'initial_capital': 10000000,
    'commission': 0.00015,
    'slippage': 0.001,
    'stock_codes': ['005930', '000660']
})

backtest_id = response.json()['backtest_id']

# 결과 조회
result = requests.get(f'http://localhost:5000/api/backtest/results/{backtest_id}')
print(result.json())
```

## 5️⃣ 결과 해석

### 주요 지표
- **Total Return**: 총 수익률
- **Annual Return**: 연환산 수익률
- **Sharpe Ratio**: 위험 조정 수익률 (1.0 이상 양호)
- **Max Drawdown**: 최대 낙폭 (20% 이내 양호)
- **Win Rate**: 승률 (50% 이상 양호)

### 좋은 전략의 기준
✅ 연환산 수익률 > 10%
✅ 샤프 비율 > 1.0
✅ 최대 낙폭 < 20%
✅ 승률 > 45%
✅ 거래 횟수 적절 (연 50~200회)

## 6️⃣ 전략 최적화 팁

1. **백테스트 기간**: 최소 1년 이상
2. **여러 시장 상황**: 상승장, 하락장, 횡보장 모두 포함
3. **거래 비용**: 실제 수수료와 슬리피지 반영
4. **오버피팅 주의**: 과도한 파라미터 조정 지양
5. **Out-of-Sample 테스트**: 다른 기간으로 검증

## 7️⃣ 주의사항

⚠️ 과거 수익률이 미래 수익을 보장하지 않음
⚠️ 백테스트는 참고용, 실전은 다를 수 있음
⚠️ 시장 상황에 맞는 전략 선택 필요
⚠️ 리스크 관리 항상 우선시