# ì „ëµ(Strategy) ì»¬ëŸ¼ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

`strategies` í…Œì´ë¸”ì˜ ìë™ë§¤ë§¤ ê´€ë ¨ ì»¬ëŸ¼ë“¤(`is_active`, `auto_execute`, `auto_trade_enabled`)ì˜ ì—­í• ê³¼ ì°¨ì´ì ì„ ì •ë¦¬í•œ ë¬¸ì„œì…ë‹ˆë‹¤.

---

## ğŸ¯ í•µì‹¬ ì»¬ëŸ¼ ë¹„êµí‘œ

| ì»¬ëŸ¼ëª… | ì˜ë¯¸ | ì„¤ì • ì‹œì  | ì£¼ìš” ì‚¬ìš©ì²˜ | `true`ì¼ ë•Œ ë™ì‘ | `false`ì¼ ë•Œ ë™ì‘ |
|--------|------|-----------|------------|-----------------|------------------|
| **`is_active`** | ì „ëµì´ ì‹œìŠ¤í…œì—ì„œ í™œì„±í™”ë˜ì–´ ìˆëŠ”ê°€? | ì „ëµ ìƒì„±/ì‚­ì œ ì‹œ | â€¢ ë°±í…ŒìŠ¤íŠ¸<br>â€¢ ëª¨ë“  UI ì¡°íšŒ<br>â€¢ SignalMonitor<br>â€¢ ëª¨ë“  ì „ëµ ëª©ë¡ | ëª¨ë“  ì‹œìŠ¤í…œì—ì„œ ì¡°íšŒ ê°€ëŠ¥ | ì‹œìŠ¤í…œì—ì„œ ìˆ¨ê¹€ (soft delete) |
| **`auto_execute`** | ìë™ë§¤ë§¤ ì‹œìŠ¤í…œì—ì„œ ì‹¤í–‰(ëª¨ë‹ˆí„°ë§)í•  ì „ëµì¸ê°€? | ìë™ë§¤ë§¤ í™œì„±í™”/ì¤‘ì§€ ì‹œ | â€¢ **RPC í•¨ìˆ˜ í•„í„°**<br>â€¢ n8n ì›Œí¬í”Œë¡œìš°<br>â€¢ SignalMonitor ì‹œì¥ ë°ì´í„° | n8nì´ ì¢…ëª©ì„ **ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§** | n8nì´ ì´ ì „ëµì„ **ì™„ì „íˆ ë¬´ì‹œ** |
| **`auto_trade_enabled`** | ì‹ í˜¸ ë°œìƒ ì‹œ ìë™ìœ¼ë¡œ ì£¼ë¬¸ì„ ìƒì„±í•  ê²ƒì¸ê°€? | ìë™ë§¤ë§¤ í™œì„±í™”/ì¤‘ì§€ ì‹œ | â€¢ SignalMonitor (ì‹ í˜¸ ì¡°íšŒ)<br>â€¢ ì£¼ë¬¸ ìƒì„± ë¡œì§ | UIì— ì‹ í˜¸ **í‘œì‹œ** + ì£¼ë¬¸ **ìë™ ìƒì„±** | UIì— ì‹ í˜¸ **ìˆ¨ê¹€** |

---

## ğŸ” ìƒì„¸ ì„¤ëª…

### 1ï¸âƒ£ `is_active` - ì „ì—­ í™œì„±í™” í”Œë˜ê·¸

**ì—­í• :** ì „ëµì´ ì‹œìŠ¤í…œ ì „ì²´ì—ì„œ "ì¡´ì¬í•˜ëŠ”ê°€"ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë²”ìš© í”Œë˜ê·¸

#### ì‚¬ìš© ìœ„ì¹˜
- âœ… ë°±í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œ
- âœ… ì „ëµ ëª©ë¡ ì¡°íšŒ (ëª¨ë“  UI)
- âœ… SignalMonitor - ì‹ í˜¸ ì¡°íšŒ
- âœ… RPC í•¨ìˆ˜ - ìë™ë§¤ë§¤ ì „ëµ ì¡°íšŒ

#### ì„¤ì • ì˜ˆì‹œ
```typescript
// ì „ëµ ìƒì„± ì‹œ
is_active: true

// ì „ëµ ì‚­ì œ ì‹œ (soft delete)
is_active: false
```

#### âš ï¸ í˜„ì¬ ë¬¸ì œì 
```
strategies í…Œì´ë¸”:
- is_active = true: 31ê°œ
- is_active = false: 5ê°œ

â†’ ì‚¬ìš©ìëŠ” 1ê°œë§Œ í™œì„±í™”í–ˆë‹¤ê³  ìƒê°í•˜ì§€ë§Œ 31ê°œê°€ í™œì„±í™”ë˜ì–´ ìˆìŒ!
â†’ ëª¨ë“  ì‹œìŠ¤í…œì— ì˜í–¥ì„ ë¯¸ì¹¨
```

---

### 2ï¸âƒ£ `auto_execute` - ìë™ë§¤ë§¤ ì‹¤í–‰ í”Œë˜ê·¸ (ëª¨ë‹ˆí„°ë§ ëŒ€ìƒ)

**ì—­í• :** n8n ì›Œí¬í”Œë¡œìš°ì™€ ìë™ë§¤ë§¤ ì‹œìŠ¤í…œì´ ì´ ì „ëµì„ ëª¨ë‹ˆí„°ë§í•  ê²ƒì¸ê°€?

#### ì‚¬ìš© ìœ„ì¹˜
- âœ… **RPC í•¨ìˆ˜ `get_active_strategies_with_universe()`ì˜ í•µì‹¬ í•„í„°**
- âœ… n8n ì›Œí¬í”Œë¡œìš° (RPCë¥¼ í†µí•´ ê°„ì ‘ ì‚¬ìš©)
- âœ… AddStrategyDialog (ì´ë¯¸ í™œì„±í™”ëœ ì „ëµ ì œì™¸)
- âœ… DebugPortfolio (í™œì„± ì „ëµ í™•ì¸)

#### RPC í•¨ìˆ˜ì—ì„œì˜ ì‚¬ìš©
**íŒŒì¼:** [sql/CREATE_SUPABASE_FUNCTION.sql](sql/CREATE_SUPABASE_FUNCTION.sql)
```sql
SELECT
    s.id as strategy_id,
    s.name as strategy_name,
    s.entry_conditions,
    s.exit_conditions,
    kif.id as filter_id,
    kif.name as filter_name,
    kif.filtered_stocks,
    s.allocated_capital,
    s.allocated_percent
FROM strategies s
INNER JOIN strategy_universes su ON s.id = su.strategy_id
INNER JOIN kw_investment_filters kif ON su.investment_filter_id = kif.id
WHERE s.auto_execute = true      -- â­ ê°€ì¥ ì¤‘ìš”í•œ í•„í„°
    AND s.is_active = true
    AND su.is_active = true
    AND kif.is_active = true;
```

#### ì„¤ì • ì˜ˆì‹œ
**íŒŒì¼:** [src/components/trading/AutoTradingPanel.tsx:238](src/components/trading/AutoTradingPanel.tsx#L238)
```typescript
// ìë™ë§¤ë§¤ í™œì„±í™” ì‹œ
auto_execute: true,
auto_trade_enabled: true,
is_active: true

// ìë™ë§¤ë§¤ ì¤‘ì§€ ì‹œ
auto_execute: false,
auto_trade_enabled: false
```

#### ë™ì‘ íë¦„
```
auto_execute = true
    â†“
RPC í•¨ìˆ˜ê°€ ì´ ì „ëµì„ ë°˜í™˜
    â†“
n8n ì›Œí¬í”Œë¡œìš° v7-1ì´ ì¡°ê±´ ê·¼ì ‘ë„ ëª¨ë‹ˆí„°ë§ ì‹œì‘
    â†“
strategy_monitoring í…Œì´ë¸”ì— ì¢…ëª©ë³„ ì ìˆ˜ ê¸°ë¡
    â†“
ì¡°ê±´ 100% ì¶©ì¡± ì‹œ trading_signals ìƒì„±
```

---

### 3ï¸âƒ£ `auto_trade_enabled` - ìë™ ì£¼ë¬¸ ìƒì„± í”Œë˜ê·¸

**ì—­í• :** ë§¤ë§¤ ì‹ í˜¸ê°€ ë°œìƒí–ˆì„ ë•Œ ìë™ìœ¼ë¡œ ì£¼ë¬¸ì„ ìƒì„±í•  ê²ƒì¸ê°€?

#### ì‚¬ìš© ìœ„ì¹˜
- âœ… SignalMonitor - ì‹ í˜¸ ëª©ë¡ ì¡°íšŒ í•„í„°
- âœ… SignalMonitor - ì „ëµ ëª©ë¡ ì¡°íšŒ í•„í„°
- âœ… ì£¼ë¬¸ ìƒì„± ë¡œì§ (ì¶”ì •)

#### SignalMonitorì—ì„œì˜ ì‚¬ìš©
**íŒŒì¼:** [src/components/SignalMonitor.tsx:204](src/components/SignalMonitor.tsx#L204)
```typescript
// ì‹¤ì‹œê°„ ë§¤ë§¤ì‹ í˜¸ ì¡°íšŒ
const { data: activeStrategyIds } = await supabase
  .from('strategies')
  .select('id')
  .eq('is_active', true)
  .eq('auto_trade_enabled', true)  // â­ ì‹ í˜¸ í•„í„°ë§

const { data, error } = await supabase
  .from('trading_signals')
  .select('*')
  .in('strategy_id', strategyIds)
  .order('created_at', { ascending: false })
  .limit(100)
```

#### ë™ì‘ íë¦„
```
auto_trade_enabled = true
    â†“
SignalMonitor UIì— ì´ ì „ëµì˜ ì‹ í˜¸ í‘œì‹œ
    â†“
n8n ì›Œí¬í”Œë¡œìš° v7-2ê°€ ì£¼ë¬¸ ìƒì„± (ì¶”ì •)
    â†“
orders í…Œì´ë¸”ì— ì£¼ë¬¸ ê¸°ë¡
```

---

## ğŸ†š ì‹œë‚˜ë¦¬ì˜¤ë³„ ë¹„êµ

### âœ… ì‹œë‚˜ë¦¬ì˜¤ 1: ì •ìƒì ì¸ ìë™ë§¤ë§¤ í™œì„±í™”

```typescript
is_active: true
auto_execute: true
auto_trade_enabled: true
```

| ì‹œìŠ¤í…œ | ë™ì‘ |
|--------|------|
| RPC í•¨ìˆ˜ | âœ… ì „ëµ ë°˜í™˜ |
| n8n ì›Œí¬í”Œë¡œìš° v7-1 | âœ… ì¡°ê±´ ëª¨ë‹ˆí„°ë§ |
| n8n ì›Œí¬í”Œë¡œìš° v7-2 | âœ… ìë™ ì£¼ë¬¸ ìƒì„± |
| SignalMonitor (ì‹œì¥ ë°ì´í„°) | âœ… ì¢…ëª© ëª¨ë‹ˆí„°ë§ |
| SignalMonitor (ì‹ í˜¸ ëª©ë¡) | âœ… ì‹ í˜¸ í‘œì‹œ |
| ë°±í…ŒìŠ¤íŠ¸ | âœ… ì¡°íšŒ ê°€ëŠ¥ |

---

### âš ï¸ ì‹œë‚˜ë¦¬ì˜¤ 2: ëª¨ë‹ˆí„°ë§ë§Œ (ì£¼ë¬¸ ìƒì„± ì•ˆ í•¨) - ì´ë¡ ìƒ

```typescript
is_active: true
auto_execute: true
auto_trade_enabled: false
```

| ì‹œìŠ¤í…œ | ë™ì‘ |
|--------|------|
| RPC í•¨ìˆ˜ | âœ… ì „ëµ ë°˜í™˜ |
| n8n ì›Œí¬í”Œë¡œìš° v7-1 | âœ… ì¡°ê±´ ëª¨ë‹ˆí„°ë§ |
| n8n ì›Œí¬í”Œë¡œìš° v7-2 | âš ï¸ **ì£¼ë¬¸ ìƒì„± ê°€ëŠ¥** (RPCë§Œ í™•ì¸) |
| SignalMonitor (ì‹œì¥ ë°ì´í„°) | âœ… ì¢…ëª© ëª¨ë‹ˆí„°ë§ |
| SignalMonitor (ì‹ í˜¸ ëª©ë¡) | âŒ ì‹ í˜¸ ìˆ¨ê¹€ |
| ë°±í…ŒìŠ¤íŠ¸ | âœ… ì¡°íšŒ ê°€ëŠ¥ |

**ë¬¸ì œì :** n8nì´ `auto_trade_enabled`ë¥¼ í™•ì¸í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì—¬ì „íˆ ì£¼ë¬¸ì„ ìƒì„±í•  ìˆ˜ ìˆìŒ!

---

### âŒ ì‹œë‚˜ë¦¬ì˜¤ 3: ìë™ë§¤ë§¤ ì¤‘ì§€

```typescript
is_active: true
auto_execute: false
auto_trade_enabled: false
```

| ì‹œìŠ¤í…œ | ë™ì‘ |
|--------|------|
| RPC í•¨ìˆ˜ | âŒ ì „ëµ ì œì™¸ |
| n8n ì›Œí¬í”Œë¡œìš° v7-1 | âŒ ëª¨ë‹ˆí„°ë§ ì•ˆ í•¨ |
| n8n ì›Œí¬í”Œë¡œìš° v7-2 | âŒ ì£¼ë¬¸ ìƒì„± ì•ˆ í•¨ |
| SignalMonitor (ì‹œì¥ ë°ì´í„°) | âŒ ëª¨ë‹ˆí„°ë§ ì•ˆ í•¨ |
| SignalMonitor (ì‹ í˜¸ ëª©ë¡) | âŒ ì‹ í˜¸ ìˆ¨ê¹€ |
| ë°±í…ŒìŠ¤íŠ¸ | âœ… ì¡°íšŒ ê°€ëŠ¥ |

---

### ğŸ—‘ï¸ ì‹œë‚˜ë¦¬ì˜¤ 4: ì „ëµ ì‚­ì œ (Soft Delete)

```typescript
is_active: false
auto_execute: false
auto_trade_enabled: false
```

| ì‹œìŠ¤í…œ | ë™ì‘ |
|--------|------|
| ëª¨ë“  ì‹œìŠ¤í…œ | âŒ ì™„ì „íˆ ë¬´ì‹œ |

---

## ğŸ”„ RPC (Remote Procedure Call)ë€?

### ì •ì˜
RPCëŠ” **PostgreSQLì— ì €ì¥ëœ ì‚¬ìš©ì ì •ì˜ í•¨ìˆ˜**ì…ë‹ˆë‹¤.

ë³µì¡í•œ SQL ì¿¼ë¦¬ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ì—ì„œ í•œ ë²ˆì— ì‹¤í–‰í•˜ê³ , ê²°ê³¼ë§Œ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ì†¡í•©ë‹ˆë‹¤.

### ì¼ë°˜ ì¿¼ë¦¬ vs RPC

#### âŒ ì¼ë°˜ ì¿¼ë¦¬ ë°©ì‹ (ë³µì¡í•¨)
```typescript
// 1ë‹¨ê³„: strategies ì¡°íšŒ
const { data: strategies } = await supabase
  .from('strategies')
  .select('*')
  .eq('auto_execute', true)
  .eq('is_active', true)

// 2ë‹¨ê³„: strategy_universes ì¡°íšŒ
const { data: universes } = await supabase
  .from('strategy_universes')
  .select('*')
  .in('strategy_id', strategies.map(s => s.id))
  .eq('is_active', true)

// 3ë‹¨ê³„: kw_investment_filters ì¡°íšŒ
const { data: filters } = await supabase
  .from('kw_investment_filters')
  .select('*')
  .in('id', universes.map(u => u.investment_filter_id))
  .eq('is_active', true)

// 4ë‹¨ê³„: JavaScriptì—ì„œ ìˆ˜ë™ìœ¼ë¡œ ì¡°ì¸...
```

#### âœ… RPC ë°©ì‹ (ê°„ë‹¨í•¨)
```typescript
// í•œ ë²ˆì˜ í˜¸ì¶œë¡œ ë!
const { data } = await supabase
  .rpc('get_active_strategies_with_universe')
```

### RPCì˜ ì¥ì 

| ì¥ì  | ì„¤ëª… |
|------|------|
| **ì„±ëŠ¥ í–¥ìƒ** | 3ê°œ í…Œì´ë¸” ì¡°ì¸ì„ ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ì—ì„œ í•œ ë²ˆì— ì²˜ë¦¬ |
| **ë„¤íŠ¸ì›Œí¬ ì ˆì•½** | ì™•ë³µ íšŸìˆ˜ ê°ì†Œ (3ë²ˆ â†’ 1ë²ˆ) |
| **ì½”ë“œ ê°„ê²°í™”** | ë³µì¡í•œ ì¡°ì¸ ë¡œì§ì„ SQLë¡œ í•œ ë²ˆë§Œ ì‘ì„± |
| **ì¬ì‚¬ìš©ì„±** | ì—¬ëŸ¬ ê³³ì—ì„œ ê°™ì€ ë¡œì§ í˜¸ì¶œ ê°€ëŠ¥ |
| **ë³´ì•ˆ** | `SECURITY DEFINER`ë¡œ ê¶Œí•œ ê´€ë¦¬ ê°€ëŠ¥ |

---

## ğŸ“Š ì „ì²´ ì‹œìŠ¤í…œ ë°ì´í„° íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì‚¬ìš©ì: "ìë™ë§¤ë§¤ ì‹œì‘" í´ë¦­             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend: AutoTradingPanel.tsx          â”‚
â”‚ UPDATE strategies SET                   â”‚
â”‚   auto_execute = true,                  â”‚
â”‚   auto_trade_enabled = true,            â”‚
â”‚   is_active = true                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ n8n ì›Œí¬í”Œë¡œìš° v7-1 (ë§¤ 1ë¶„)            â”‚
â”‚ RPC: get_active_strategies_with_...     â”‚
â”‚   WHERE auto_execute = true             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì¢…ëª©ë³„ ì¡°ê±´ ê·¼ì ‘ë„ ê³„ì‚°                  â”‚
â”‚ â†’ strategy_monitoring í…Œì´ë¸” ì €ì¥       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì¡°ê±´ 100% ì¶©ì¡± ì‹œ                        â”‚
â”‚ â†’ trading_signals í…Œì´ë¸” INSERT         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SignalMonitor UI                        â”‚
â”‚ WHERE auto_trade_enabled = true         â”‚
â”‚ â†’ ì‹ í˜¸ í‘œì‹œ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ n8n ì›Œí¬í”Œë¡œìš° v7-2 (ë§¤ 1ë¶„)            â”‚
â”‚ â†’ Kiwoom API ì£¼ë¬¸ ìƒì„±                  â”‚
â”‚ â†’ orders í…Œì´ë¸” INSERT                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš ï¸ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë¬¸ì œì 

### 1. `is_active = true`ì¸ ì „ëµì´ 31ê°œ
```sql
SELECT COUNT(*) FROM strategies WHERE is_active = true;
-- ê²°ê³¼: 31ê°œ

SELECT COUNT(*) FROM strategies WHERE auto_execute = true;
-- ê²°ê³¼: ?ê°œ (í™•ì¸ í•„ìš”)
```

**ì˜í–¥:**
- ëª¨ë“  UIì—ì„œ 31ê°œ ì „ëµì´ ì¡°íšŒë¨
- ë°±í…ŒìŠ¤íŠ¸, SignalMonitor ë“± ì‹œìŠ¤í…œ ì „ë°˜ì— ì˜í–¥
- RPC í•¨ìˆ˜ë„ `is_active = true` ì¡°ê±´ì„ í¬í•¨í•˜ë¯€ë¡œ ì˜í–¥ ë°›ìŒ

### 2. `auto_execute`ì™€ `auto_trade_enabled`ì˜ ë¶ˆì¼ì¹˜ ê°€ëŠ¥ì„±
- n8n ì›Œí¬í”Œë¡œìš°ëŠ” `auto_execute`ë§Œ í™•ì¸ (RPC í†µí•´)
- SignalMonitor UIëŠ” `auto_trade_enabled`ë¡œ ì‹ í˜¸ í•„í„°ë§
- ì£¼ë¬¸ ìƒì„± ë¡œì§ì´ ì–´ë–¤ ì»¬ëŸ¼ì„ í™•ì¸í•˜ëŠ”ì§€ ë¶ˆëª…í™•

### 3. ì»¬ëŸ¼ ì—­í• ì˜ ì¤‘ë³µ
í˜„ì¬ëŠ” í•­ìƒ ê°™ì´ ì„¤ì •ë¨:
```typescript
// í™œì„±í™” ì‹œ
auto_execute: true
auto_trade_enabled: true

// ì¤‘ì§€ ì‹œ
auto_execute: false
auto_trade_enabled: false
```

**ì œì•ˆ:**
- ë‘ ì»¬ëŸ¼ì„ í•­ìƒ ë™ì¼í•˜ê²Œ ìœ ì§€ (ì¤‘ë³µ ì œê±°)
- ë˜ëŠ” ì—­í• ì„ ëª…í™•íˆ ë¶„ë¦¬ (ëª¨ë‹ˆí„°ë§ë§Œ vs ì£¼ë¬¸ ìƒì„±ê¹Œì§€)

---

## âœ… ê¶Œì¥ ì‚¬í•­

### 1. 31ê°œ í™œì„± ì „ëµ ì •ë¦¬
```sql
-- ëª¨ë“  ì „ëµ ë¹„í™œì„±í™”
UPDATE strategies SET is_active = false;

-- ì‹¤ì œ ì‚¬ìš©í•  ì „ëµë§Œ í™œì„±í™”
UPDATE strategies
SET is_active = true
WHERE name = '[í…œí”Œë¦¿] ë³¼ë¦°ì €ë°´ë“œ';
```

### 2. ì»¬ëŸ¼ ì‚¬ìš© ê·œì¹™ ì •ë¦½

| ìƒí™© | `is_active` | `auto_execute` | `auto_trade_enabled` |
|------|-------------|----------------|---------------------|
| ì „ëµ ìƒì„± | `true` | `false` | `false` |
| ìë™ë§¤ë§¤ í™œì„±í™” | `true` | `true` | `true` |
| ìë™ë§¤ë§¤ ì¤‘ì§€ | `true` | `false` | `false` |
| ì „ëµ ì‚­ì œ | `false` | `false` | `false` |

### 3. ì½”ë“œ ì¼ê´€ì„± ìœ ì§€
- ìë™ë§¤ë§¤ í™œì„±í™”/ì¤‘ì§€ ì‹œ **ì„¸ ì»¬ëŸ¼ì„ í•­ìƒ í•¨ê»˜** ì—…ë°ì´íŠ¸
- RPC í•¨ìˆ˜ì™€ UIê°€ **ë™ì¼í•œ í•„í„° ì¡°ê±´** ì‚¬ìš©í•˜ë„ë¡ í†µì¼

---

## ğŸ“š ê´€ë ¨ íŒŒì¼

| íŒŒì¼ | ì—­í•  |
|------|------|
| [sql/CREATE_SUPABASE_FUNCTION.sql](sql/CREATE_SUPABASE_FUNCTION.sql) | RPC í•¨ìˆ˜ ì •ì˜ |
| [src/components/trading/AutoTradingPanel.tsx](src/components/trading/AutoTradingPanel.tsx) | ìë™ë§¤ë§¤ í™œì„±í™”/ì¤‘ì§€ |
| [src/components/trading/AutoTradingPanelV2.tsx](src/components/trading/AutoTradingPanelV2.tsx) | ìë™ë§¤ë§¤ í¬íŠ¸í´ë¦¬ì˜¤ UI |
| [src/components/SignalMonitor.tsx](src/components/SignalMonitor.tsx) | ì‹¤ì‹œê°„ ì‹ í˜¸ ëª¨ë‹ˆí„°ë§ |
| [src/pages/DebugPortfolio.tsx](src/pages/DebugPortfolio.tsx) | ë””ë²„ê¹… í˜ì´ì§€ |
| [n8n-workflows/README-v7.md](n8n-workflows/README-v7.md) | n8n ì›Œí¬í”Œë¡œìš° ê°€ì´ë“œ |

---

## ğŸ” ë‹¤ìŒ í™•ì¸ í•„ìš” ì‚¬í•­

1. **í˜„ì¬ `auto_execute = true`ì¸ ì „ëµ ê°œìˆ˜ í™•ì¸**
   ```sql
   SELECT id, name, auto_execute, auto_trade_enabled, is_active
   FROM strategies
   WHERE auto_execute = true;
   ```

2. **n8n ì›Œí¬í”Œë¡œìš° v7-2ì—ì„œ ì£¼ë¬¸ ìƒì„± ì¡°ê±´ í™•ì¸**
   - `auto_execute`ë§Œ í™•ì¸í•˜ëŠ”ê°€?
   - `auto_trade_enabled`ë„ í™•ì¸í•˜ëŠ”ê°€?

3. **31ê°œ ì „ëµ ì •ë¦¬ ì‹¤í–‰ ì—¬ë¶€ ê²°ì •**
   - cleanup_strategies_urgent.sql ì‹¤í–‰ ì—¬ë¶€

---

**ì‘ì„±ì¼:** 2025-11-19
**ë²„ì „:** 1.0
