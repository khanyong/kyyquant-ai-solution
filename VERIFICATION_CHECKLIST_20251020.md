# 리팩토링 전 기능 검증 체크리스트

> **목적**: 리팩토링 전 현재 코드의 정상 작동 여부 확인
> **작성일**: 2025-10-20
> **원칙**: 리팩토링 후 이 체크리스트를 다시 실행하여 기능 유지 확인

---

## 🎯 검증 전략

### 1. 빌드 검증
- [ ] TypeScript 컴파일 성공
- [ ] Vite 빌드 성공
- [ ] 빌드 에러 0개
- [ ] 빌드 경고 확인 (치명적 경고 없음)

### 2. 런타임 검증
- [ ] 개발 서버 정상 구동
- [ ] 콘솔 에러 없음
- [ ] 초기 로딩 성공

### 3. 기능별 검증
- 리팩토링 대상 파일의 모든 기능 테스트

---

## 📋 Phase 1: 빌드 검증

### 1-1. TypeScript 컴파일
```bash
npm run build
```

**체크포인트:**
- [ ] `tsc` 컴파일 성공
- [ ] 타입 에러 0개
- [ ] `vite build` 성공
- [ ] dist 폴더 생성 확인

**현재 상태 기록:**
```
빌드 시간: ___초
번들 크기: ___KB
경고 개수: ___개
```

### 1-2. 개발 서버 구동
```bash
npm run dev
```

**체크포인트:**
- [ ] 서버 시작 성공 (포트 확인)
- [ ] 브라우저 자동 열림
- [ ] Hot Module Replacement 작동

---

## 📋 Phase 2: TradingSettingsWithUniverse.tsx 검증

> **파일**: `src/components/TradingSettingsWithUniverse.tsx` (2,374줄)
> **접근 경로**: 자동매매 탭 → 매매 설정

### 2-1. 페이지 로딩
- [ ] 페이지 렌더링 성공
- [ ] 콘솔 에러 없음
- [ ] 로딩 스피너 정상 표시
- [ ] 데이터 로드 완료

### 2-2. 종목 선택 (UniverseSelector)
- [ ] 종목 검색 기능
- [ ] 종목 선택/해제
- [ ] 전체 선택/해제
- [ ] 선택된 종목 개수 표시
- [ ] 종목 필터링 (시가총액, 거래량 등)

**테스트 데이터:**
```
종목 검색: "삼성전자"
예상 결과: 검색 결과 표시
```

### 2-3. 지표 설정 (IndicatorSettings)
- [ ] 지표 추가 버튼
- [ ] 지표 목록 표시
- [ ] 지표 파라미터 수정
- [ ] 지표 삭제
- [ ] 지표 프리셋 저장
- [ ] 지표 프리셋 로드

**테스트 시나리오:**
```
1. RSI 지표 추가
2. 기간 파라미터를 14 → 20으로 변경
3. 저장 버튼 클릭
4. 페이지 새로고침
5. 설정 유지 확인
```

### 2-4. 매매 설정 폼 (TradingForm)
- [ ] 매수 조건 설정
- [ ] 매도 조건 설정
- [ ] 손절/익절 설정
- [ ] 투자 금액 설정
- [ ] 폼 유효성 검증
- [ ] 저장 버튼 작동

**테스트 입력:**
```
매수 조건: RSI < 30
매도 조건: RSI > 70
손절: -5%
익절: +10%
투자 금액: 1,000,000원
```

### 2-5. 차트 표시 (ChartPanel)
- [ ] 차트 렌더링
- [ ] 지표 오버레이 표시
- [ ] 차트 줌/패닝
- [ ] 시간대 변경
- [ ] 차트 데이터 업데이트

### 2-6. 통합 테스트
- [ ] 설정 저장 → 로드 → 수정 → 재저장
- [ ] 여러 탭 전환 후 돌아와도 상태 유지
- [ ] 브라우저 새로고침 후 데이터 복원

**스크린샷 촬영:**
- [ ] 초기 화면
- [ ] 종목 선택 화면
- [ ] 지표 설정 화면
- [ ] 완성된 설정 화면

---

## 📋 Phase 3: InvestmentSettingsComplete.tsx 검증

> **파일**: `src/pages/InvestmentSettingsComplete.tsx` (2,451줄)
> **접근 경로**: 설정 → 투자 설정

### 3-1. 페이지 로딩
- [ ] 페이지 렌더링 성공
- [ ] 초기 데이터 로드
- [ ] 기본값 설정 확인

### 3-2. 투자 설정 폼
- [ ] 투자 금액 입력
- [ ] 투자 비율 설정
- [ ] 최소/최대 투자 금액
- [ ] 분할 매수 설정
- [ ] 리밸런싱 주기

**테스트 입력:**
```
총 투자 금액: 10,000,000원
최소 투자 금액: 100,000원
최대 종목 수: 10개
리밸런싱: 매월
```

### 3-3. 포트폴리오 배분
- [ ] 종목별 비율 설정
- [ ] 자동 균등 배분
- [ ] 시가총액 가중 배분
- [ ] 커스텀 비율 입력
- [ ] 총 합계 100% 검증

**테스트:**
```
종목 3개 선택
균등 배분: 각 33.33%
합계: 100% 확인
```

### 3-4. 리스크 관리
- [ ] 포트폴리오 손절 설정
- [ ] 일일 최대 손실 설정
- [ ] 변동성 제한
- [ ] 집중도 제한
- [ ] 경고 알림 설정

**테스트 입력:**
```
포트폴리오 손절: -10%
일일 최대 손실: -3%
단일 종목 최대 비중: 20%
```

### 3-5. 목표 수익률 설정
- [ ] 목표 수익률 입력
- [ ] 목표 달성 시 액션
- [ ] 진행률 표시
- [ ] 예상 달성 기간 계산

### 3-6. 저장 및 로드
- [ ] 설정 저장 (Supabase)
- [ ] 저장 성공 메시지
- [ ] 페이지 새로고침 후 로드
- [ ] 설정 내보내기 (JSON)
- [ ] 설정 가져오기 (JSON)

---

## 📋 Phase 4: StrategyBuilder.tsx 검증

> **파일**: `src/components/StrategyBuilder.tsx` (2,272줄)
> **접근 경로**: 전략 → 전략 빌더

### 4-1. 전략 생성
- [ ] 새 전략 생성 버튼
- [ ] 전략 이름 입력
- [ ] 전략 설명 입력
- [ ] 템플릿 선택

### 4-2. 조건 빌더 (ConditionBuilder)
- [ ] 매수 조건 추가
- [ ] 매도 조건 추가
- [ ] AND/OR 로직 조합
- [ ] 조건 삭제
- [ ] 조건 순서 변경

**테스트 조건:**
```
매수: (RSI < 30) AND (거래량 > 평균거래량 * 2)
매도: (RSI > 70) OR (수익률 > 10%)
```

### 4-3. 지표 선택
- [ ] 사용 가능한 지표 목록
- [ ] 지표 검색
- [ ] 지표 상세 정보
- [ ] 지표 파라미터 설정

### 4-4. 백테스트 미리보기
- [ ] 백테스트 실행 버튼
- [ ] 진행률 표시
- [ ] 결과 차트 표시
- [ ] 성과 지표 표시
- [ ] 거래 내역 표시

### 4-5. 전략 검증
- [ ] 조건식 문법 검증
- [ ] 순환 참조 체크
- [ ] 필수 필드 검증
- [ ] 경고 메시지 표시

### 4-6. 저장 및 불러오기
- [ ] 전략 저장
- [ ] 전략 목록 조회
- [ ] 전략 불러오기
- [ ] 전략 삭제
- [ ] 전략 복제

---

## 📋 Phase 5: StrategyAnalyzer.tsx 검증

> **파일**: `src/components/StrategyAnalyzer.tsx` (1,755줄)

### 5-1. 전략 분석
- [ ] 전략 선택
- [ ] 분석 실행
- [ ] 성과 지표 계산
- [ ] 리스크 지표 계산
- [ ] 샤프 비율, MDD 등

### 5-2. 차트 분석
- [ ] 수익률 곡선
- [ ] 드로우다운 차트
- [ ] 월별 수익률 히트맵
- [ ] 거래 분포 차트

### 5-3. 거래 내역 분석
- [ ] 거래 내역 테이블
- [ ] 필터링 (승/패, 기간)
- [ ] 정렬 기능
- [ ] 상세 내역 보기
- [ ] CSV 내보내기

---

## 📋 Phase 6: BacktestRunner.tsx 검증

> **파일**: `src/components/BacktestRunner.tsx` (1,829줄)

### 6-1. 백테스트 설정
- [ ] 전략 선택
- [ ] 기간 설정
- [ ] 초기 자본 입력
- [ ] 수수료 설정
- [ ] 슬리피지 설정

### 6-2. 백테스트 실행
- [ ] 실행 버튼
- [ ] 진행률 표시 (0-100%)
- [ ] 예상 소요 시간
- [ ] 취소 버튼

### 6-3. 결과 표시
- [ ] 최종 수익률
- [ ] 승률
- [ ] 총 거래 횟수
- [ ] 최대 낙폭 (MDD)
- [ ] 샤프 비율

### 6-4. 비교 분석
- [ ] 여러 전략 비교
- [ ] 벤치마크 비교 (코스피, 코스닥)
- [ ] 비교 차트
- [ ] 상대 성과

---

## 📋 Phase 7: 공통 기능 검증

### 7-1. 인증 (Auth)
- [ ] 로그인
- [ ] 로그아웃
- [ ] 회원가입
- [ ] 비밀번호 재설정
- [ ] 세션 유지

### 7-2. 데이터베이스 (Supabase)
- [ ] 데이터 조회 (SELECT)
- [ ] 데이터 생성 (INSERT)
- [ ] 데이터 수정 (UPDATE)
- [ ] 데이터 삭제 (DELETE)
- [ ] 실시간 업데이트 (Realtime)

### 7-3. API 연동
- [ ] 키움 API 연결
- [ ] 계좌 정보 조회
- [ ] 주문 실행
- [ ] 체결 확인
- [ ] 잔고 조회

### 7-4. n8n 워크플로우 모니터링
- [ ] 워크플로우 목록 조회
- [ ] 실행 내역 조회
- [ ] 노드별 상태 확인
- [ ] 30초 자동 새로고침
- [ ] 에러 표시

---

## 📋 Phase 8: 통합 시나리오 테스트

### 시나리오 1: 전략 생성부터 실행까지
```
1. 로그인
2. 전략 빌더에서 새 전략 생성
3. 매수/매도 조건 설정
4. 백테스트 실행
5. 결과 분석
6. 전략 저장
7. 자동매매 탭에서 전략 활성화
```

- [ ] 모든 단계 정상 작동
- [ ] 데이터 일관성 유지
- [ ] 에러 없음

### 시나리오 2: 포트폴리오 관리
```
1. 투자 설정에서 총 금액 설정
2. 종목 선택
3. 포트폴리오 비율 설정
4. 리스크 관리 설정
5. 저장
6. 자동매매 탭에서 확인
```

- [ ] 모든 단계 정상 작동
- [ ] 설정 반영 확인

### 시나리오 3: 실시간 모니터링
```
1. 자동매매 활성화
2. n8n 워크플로우 모니터링 확인
3. 시장 데이터 실시간 업데이트
4. 매매 신호 발생 확인
5. 주문 실행 및 체결 확인
```

- [ ] 실시간 데이터 업데이트
- [ ] 워크플로우 정상 작동

---

## 📋 Phase 9: 성능 측정

### 9-1. 로딩 시간
```
초기 로딩: ___초
페이지 전환: ___초
데이터 로드: ___초
```

### 9-2. 번들 크기
```
dist/index.js: ___KB
gzip: ___KB
```

### 9-3. 메모리 사용량
```
초기: ___MB
전략 빌더 사용 후: ___MB
백테스트 실행 후: ___MB
```

### 9-4. 콘솔 로그 확인
- [ ] Error 0개
- [ ] Warning 확인 (치명적 경고 없음)
- [ ] Deprecated API 사용 없음

---

## 📋 Phase 10: 브라우저 호환성

### 10-1. Chrome (최신)
- [ ] 모든 기능 정상 작동
- [ ] 콘솔 에러 없음
- [ ] 레이아웃 정상

### 10-2. Edge
- [ ] 기본 기능 테스트
- [ ] 차트 렌더링 확인

### 10-3. Firefox (선택)
- [ ] 기본 기능 테스트

---

## 📊 검증 결과 요약

### 전체 체크리스트
```
총 항목: ___개
통과: ___개
실패: ___개
보류: ___개
```

### 치명적 이슈
```
1.
2.
3.
```

### 경미한 이슈
```
1.
2.
3.
```

### 개선 권장 사항
```
1.
2.
3.
```

---

## 🎬 다음 단계

### 검증 완료 후
- [ ] 검증 결과 문서화
- [ ] 스크린샷/동영상 저장
- [ ] 이슈 목록 작성
- [ ] 리팩토링 우선순위 재조정

### 리팩토링 시작 전 준비
- [ ] Git 브랜치 생성 (`refactor/phase-1`)
- [ ] 베이스라인 코드 커밋
- [ ] 테스트 환경 준비

---

## 📝 검증 로그

### 검증 일시
- 시작: 2025-10-20 ___:___
- 종료: 2025-10-20 ___:___
- 소요 시간: ___시간

### 검증자
- 이름:
- 환경: Windows / macOS / Linux
- 브라우저: Chrome ___

### 특이사항
```
1.
2.
3.
```

---

## 💡 참고사항

### 검증 시 주의사항
1. **실제 데이터 사용 금지**: 테스트 계정 사용
2. **실제 주문 금지**: 모의투자 환경 사용
3. **백업**: 검증 전 데이터베이스 백업

### 문제 발생 시
1. 콘솔 로그 캡처
2. Network 탭 확인
3. 재현 가능한 최소 단계 기록
4. 스크린샷/동영상 저장

---

**리팩토링 원칙**: 이 체크리스트의 모든 항목이 PASS여야만 리팩토링 완료로 간주
