# 백테스트 전략 샘플

UI에서 직접 설정할 수 있는 전략 샘플들입니다. 복사해서 사용하세요.

---

## 샘플 1: 보수적 전략 (RSI + 볼린저 밴드)

### 📊 전략 개요
- **성격**: 보수적, 안정적 수익 추구
- **매수 신호**: 과매도 구간 + 볼린저 하단
- **목표 수익**: 단계별 분할 익절
- **리스크 관리**: 동적 손절선으로 수익 보호

### 매수 조건
```
조건 1: RSI < 35
조건 2: close < bollinger_lower
결합: AND
```

**설정 방법:**
1. 지표 추가: RSI (기간 14), Bollinger Bands (기간 20, 표준편차 2)
2. 매수 조건 추가:
   - 왼쪽: `rsi`, 연산자: `<`, 오른쪽: `35`
   - 왼쪽: `close`, 연산자: `<`, 오른쪽: `bollinger_lower`
   - combineWith: `AND`

### 매도 조건
```
조건 1: RSI > 70
조건 2: close > bollinger_upper
결합: OR
```

**설정 방법:**
1. 매도 조건 추가:
   - 왼쪽: `rsi`, 연산자: `>`, 오른쪽: `70`
   - 왼쪽: `close`, 연산자: `>`, 오른쪽: `bollinger_upper`
   - combineWith: `OR`

### 목표 수익률 설정
```
모드: 단계별 목표
- 1단계: 3% 도달 → 50% 매도, 손절→본전 ✓
- 2단계: 5% 도달 → 30% 매도, 손절→1단계가 ✓
- 3단계: 8% 도달 → 20% 매도, 손절→2단계가 ✓
```

**설정 방법:**
1. "단계별 목표" 탭 선택
2. "단계별 목표 수익률 사용" 활성화
3. 각 단계 설정:
   - 1단계: 목표 3%, 매도 비율 50%, "손절→본전" 체크
   - 2단계: 목표 5%, 매도 비율 30%, "손절→1단계가" 체크
   - 3단계: 목표 8%, 매도 비율 20%, "손절→2단계가" 체크

### 손절 라인
```
손절 라인 사용: ✓
손절 라인: 3%
동적 손절: ✓ (단계별 자동 조정)
```

**설정 방법:**
1. "손절 라인 사용" 활성화
2. 손절 라인: `3` 입력
3. "동적 손절" 체크 (자동으로 단계별 조정됨)

### 예상 결과
- 안정적인 수익 실현 (3%, 5%, 8% 단계별 분할 익절)
- 손실 최소화 (초기 -3% 손절, 이후 동적 상향)
- 수익 보호 (1단계 도달 후 본전 이상 보장)

---

## 샘플 2: 공격적 전략 (MACD + 골든크로스)

### 📊 전략 개요
- **성격**: 공격적, 추세 추종
- **매수 신호**: 골든크로스 + MACD 상승
- **목표 수익**: 높은 수익 목표
- **리스크 관리**: 낮은 손절선, 큰 수익 노림

### 매수 조건
```
조건 1: sma_5 cross_above sma_20 (골든크로스)
조건 2: macd > signal
결합: AND
```

**설정 방법:**
1. 지표 추가: SMA (기간 5), SMA (기간 20), MACD (12, 26, 9)
2. 매수 조건 추가:
   - 왼쪽: `sma_5`, 연산자: `cross_above`, 오른쪽: `sma_20`
   - 왼쪽: `macd`, 연산자: `>`, 오른쪽: `signal`
   - combineWith: `AND`

### 매도 조건
```
조건 1: sma_5 cross_below sma_20 (데드크로스)
조건 2: macd < signal
결합: OR
```

**설정 방법:**
1. 매도 조건 추가:
   - 왼쪽: `sma_5`, 연산자: `cross_below`, 오른쪽: `sma_20`
   - 왼쪽: `macd`, 연산자: `<`, 오른쪽: `signal`
   - combineWith: `OR`

### 목표 수익률 설정
```
모드: 단계별 목표
- 1단계: 5% 도달 → 50% 매도, 손절→본전 ✓
- 2단계: 10% 도달 → 30% 매도, 손절→1단계가 ✓
- 3단계: 15% 도달 → 20% 매도, 손절→2단계가 ✓
```

### 손절 라인
```
손절 라인 사용: ✓
손절 라인: 5%
동적 손절: ✓
```

### 예상 결과
- 큰 수익 가능 (5%, 10%, 15% 단계별)
- 추세 추종으로 긴 보유 기간
- 높은 변동성, 거래 횟수 적음

---

## 샘플 3: 균형 전략 (RSI + SMA)

### 📊 전략 개요
- **성격**: 균형잡힌 중도 전략
- **매수 신호**: 과매도 + 이동평균 지지
- **목표 수익**: 중간 수익 목표
- **리스크 관리**: 적정 손절선 + 동적 조정

### 매수 조건
```
조건 1: RSI < 40
조건 2: close > sma_20
결합: AND
```

**설정 방법:**
1. 지표 추가: RSI (기간 14), SMA (기간 20)
2. 매수 조건:
   - 왼쪽: `rsi`, 연산자: `<`, 오른쪽: `40`
   - 왼쪽: `close`, 연산자: `>`, 오른쪽: `sma_20`
   - combineWith: `AND`

### 매도 조건
```
조건 1: RSI > 65
조건 2: close < sma_20
결합: OR
```

**설정 방법:**
1. 매도 조건:
   - 왼쪽: `rsi`, 연산자: `>`, 오른쪽: `65`
   - 왼쪽: `close`, 연산자: `<`, 오른쪽: `sma_20`
   - combineWith: `OR`

### 목표 수익률 설정
```
모드: 단계별 목표
- 1단계: 4% 도달 → 50% 매도, 손절→본전 ✓
- 2단계: 7% 도달 → 30% 매도, 손절→1단계가 ✓
- 3단계: 12% 도달 → 20% 매도, 손절→2단계가 ✓
```

### 손절 라인
```
손절 라인 사용: ✓
손절 라인: 4%
동적 손절: ✓
```

### 예상 결과
- 균형잡힌 수익/리스크 비율
- 중간 정도의 거래 빈도
- 안정적인 수익 곡선

---

## 샘플 4: 단순 목표 전략 (테스트용)

### 📊 전략 개요
- **성격**: 단순하고 명확한 전략
- **매수 신호**: RSI 과매도
- **목표 수익**: 단순 5% 목표
- **리스크 관리**: 고정 손절

### 매수 조건
```
조건 1: RSI < 30
```

**설정 방법:**
1. 지표 추가: RSI (기간 14)
2. 매수 조건:
   - 왼쪽: `rsi`, 연산자: `<`, 오른쪽: `30`

### 매도 조건
```
조건 1: RSI > 70
```

**설정 방법:**
1. 매도 조건:
   - 왼쪽: `rsi`, 연산자: `>`, 오른쪽: `70`

### 목표 수익률 설정
```
모드: 단일 목표
목표 수익률: 5%
```

**설정 방법:**
1. "단일 목표" 탭 선택
2. 목표 수익률: `5` 입력

### 손절 라인
```
손절 라인 사용: ✓
손절 라인: 3%
```

### 예상 결과
- 명확한 진입/청산 기준
- 단순하여 이해하기 쉬움
- 백테스트 결과 검증 용이

---

## 샘플 5: 스윙 트레이딩 전략 (일목균형표)

### 📊 전략 개요
- **성격**: 중장기 스윙 트레이딩
- **매수 신호**: 일목균형표 전환선 상향 돌파
- **목표 수익**: 큰 수익 목표
- **리스크 관리**: 여유있는 손절

### 매수 조건
```
조건 1: tenkan cross_above kijun
조건 2: close > kumo_top
결합: AND
```

**설정 방법:**
1. 지표 추가: 일목균형표 (기본값)
2. 매수 조건:
   - 왼쪽: `tenkan`, 연산자: `cross_above`, 오른쪽: `kijun`
   - 왼쪽: `close`, 연산자: `>`, 오른쪽: `kumo_top`
   - combineWith: `AND`

### 매도 조건
```
조건 1: tenkan cross_below kijun
조건 2: close < kumo_bottom
결합: OR
```

**설정 방법:**
1. 매도 조건:
   - 왼쪽: `tenkan`, 연산자: `cross_below`, 오른쪽: `kijun`
   - 왼쪽: `close`, 연산자: `<`, 오른쪽: `kumo_bottom`
   - combineWith: `OR`

### 목표 수익률 설정
```
모드: 단계별 목표
- 1단계: 6% 도달 → 40% 매도, 손절→본전 ✓
- 2단계: 12% 도달 → 30% 매도, 손절→1단계가 ✓
- 3단계: 20% 도달 → 30% 매도, 손절→2단계가 ✓
```

### 손절 라인
```
손절 라인 사용: ✓
손절 라인: 6%
동적 손절: ✓
```

### 예상 결과
- 큰 수익 잠재력
- 낮은 거래 빈도
- 긴 보유 기간

---

## 🎯 추천 테스트 순서

1. **샘플 4** (단순 목표 전략)
   - 가장 단순하여 동작 확인 용이
   - 기본 기능 검증

2. **샘플 1** (보수적 전략)
   - 동적 손절선 동작 확인
   - 단계별 익절 검증

3. **샘플 3** (균형 전략)
   - 복합 조건 테스트
   - 실전 활용 가능

4. **샘플 2** (공격적 전략)
   - cross_above/cross_below 연산자 테스트
   - 높은 수익 목표 검증

5. **샘플 5** (일목균형표)
   - 복잡한 지표 조합 테스트
   - 스윙 트레이딩 시뮬레이션

---

## 💡 백테스트 실행 팁

### 추천 설정
```
종목: 005930 (삼성전자)
기간: 최근 6개월
초기 자금: 10,000,000원
수수료: 0.15%
슬리피지: 0.1%
포지션 크기: 30%
```

### 확인 포인트
1. ✅ 거래 횟수가 0이 아닌지
2. ✅ 단계별 매도가 실행되는지
3. ✅ 매도 이유가 정확한지 (stage_1_target, stage_2_target 등)
4. ✅ 손절이 동적으로 조정되는지
5. ✅ 수익률이 합리적인지

### 결과 분석
- **거래 내역 탭**: 각 거래의 상세 정보 확인
- **매도 이유**: `stage_N_target` 또는 `stop_loss` 표시 확인
- **수익률 차트**: 자산 변화 추이 확인
- **통계**: 승률, 평균 수익률, 최대 낙폭 등

---

## 🔍 문제 발생 시 체크리스트

### 거래가 하나도 안 생기는 경우
- [ ] 매수 조건이 너무 엄격하지 않은지
- [ ] 지표 이름이 정확한지 (예: `rsi` not `RSI`)
- [ ] 기간이 충분한지 (최소 3개월 이상 권장)

### 단계별 매도가 안 되는 경우
- [ ] "단계별 목표 수익률 사용" 활성화했는지
- [ ] 각 단계의 목표 수익률이 올바른지
- [ ] dynamicStopLoss 체크박스 확인

### 손절이 작동 안 하는 경우
- [ ] "손절 라인 사용" 활성화했는지
- [ ] 손절 라인 값이 양수로 입력되었는지 (3% → `3`)

---

## 📝 설정 JSON 예시 (개발자용)

샘플 1 전략의 완전한 JSON 설정:

```json
{
  "name": "보수적 전략",
  "indicators": [
    { "name": "rsi", "params": { "period": 14 } },
    { "name": "bollinger", "params": { "period": 20, "std": 2 } }
  ],
  "buyConditions": [
    { "left": "rsi", "operator": "<", "right": 35 },
    { "left": "close", "operator": "<", "right": "bollinger_lower", "combineWith": "AND" }
  ],
  "sellConditions": [
    { "left": "rsi", "operator": ">", "right": 70 },
    { "left": "close", "operator": ">", "right": "bollinger_upper", "combineWith": "OR" }
  ],
  "targetProfit": {
    "mode": "staged",
    "staged": {
      "enabled": true,
      "stages": [
        { "stage": 1, "targetProfit": 3, "exitRatio": 50, "dynamicStopLoss": true },
        { "stage": 2, "targetProfit": 5, "exitRatio": 30, "dynamicStopLoss": true },
        { "stage": 3, "targetProfit": 8, "exitRatio": 20, "dynamicStopLoss": true }
      ],
      "combineWith": "OR"
    }
  },
  "stopLoss": {
    "enabled": true,
    "value": 3
  },
  "position_size": 0.3
}
```

이 설정들을 UI에서 직접 입력하면 동일한 전략이 만들어집니다! 🎉
